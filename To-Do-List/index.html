<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>To-Do-List</title>
    <link rel="stylesheet" href="style.css" type="text/css">
</head>
<body>
    <div class="container">
        <div class="todo-app">
            <h2>To-Do List <img src="images/icon.png" alt="icon"></h2>
            <div class="row">
                <input type="text" id="input-box" placeholder="Add your text">
                <button onclick="addTask()">Add</button>
            </div>
            <ul id="list-container">
                <!--<li class="checked">Task 1</li>
                <li>Task 2</li>
                <li>Task 3</li>-->
            </ul>
        </div>
    </div>
    <script src="script.js"></script>
</body>

</html>



import React, { useState, useEffect } from 'react';
import { useNavigate, useLocation } from 'react-router-dom';
import './UserApplication.css';

export const UserApplication = () => {
  const navigate = useNavigate();
  const location = useLocation();
  
  const [formData, setFormData] = useState({
    firstName: '',
    lastName: '',
    email: '',
    contactNumber: '',
    cardType: 'gold',
    address: '',
    city: '',
    pincode: '',
    incomeTask: '',
    aadharCard: null,
    panCard: null,
    incomeTaxProof: null
  });

  const [submittedData, setSubmittedData] = useState(null);
  const [isEditing, setIsEditing] = useState(false);
  const [editingApplicationId, setEditingApplicationId] = useState(null);
  const [uploadingFiles, setUploadingFiles] = useState({
    aadhar: false,
    pan: false,
    incomeTax: false
  });
  const [errors, setErrors] = useState({});
  const [applicationHistory, setApplicationHistory] = useState([]);
  const [showHistory, setShowHistory] = useState(false);
  const [hasActiveApplication, setHasActiveApplication] = useState(false);
  const [showSuccessMessage, setShowSuccessMessage] = useState(false);

  useEffect(() => {
    loadApplicationData();
  }, []);

  const loadApplicationData = () => {
  // Load current active application
  const saved = localStorage.getItem('creditCardApplication');
  const allApplicationsData = localStorage.getItem('allApplications');
  
  if (allApplicationsData) {
    const allApps = JSON.parse(allApplicationsData);
    // Filter to show only approved applications in history
    setApplicationHistory(allApps.filter(app => app.status === 'approved'));
  }
  
  if (saved) {
    const parsed = JSON.parse(saved);
    
    // If approved, move to history and clear current
    if (parsed.status === 'approved') {
      const allApps = JSON.parse(localStorage.getItem('allApplications') || '[]');
      const exists = allApps.find(app => app.id === parsed.id);
      
      if (!exists) {
        allApps.unshift(parsed);
        localStorage.setItem('allApplications', JSON.stringify(allApps));
        setApplicationHistory(allApps.filter(app => app.status === 'approved'));
      }
      
      localStorage.removeItem('creditCardApplication');
      setSubmittedData(null);
      setHasActiveApplication(false);
      return;
    }
    
    setSubmittedData(parsed);
    
    // Only block if in-process
    if (parsed.status === 'in-process') {
      setHasActiveApplication(true);
    } else if (parsed.status === 'rejected') {
      // Allow editing for rejected applications
      setHasActiveApplication(false);
    }
  }

  // Check if we're coming from edit button
  if (location.state?.editApplication) {
    const appToEdit = location.state.editApplication;
    setIsEditing(true);
    setEditingApplicationId(appToEdit.id);
    setFormData({
      firstName: appToEdit.firstName || '',
      lastName: appToEdit.lastName || '',
      email: appToEdit.email || '',
      contactNumber: appToEdit.contactNumber || '',
      cardType: appToEdit.cardType || 'gold',
      address: appToEdit.address || '',
      city: appToEdit.city || '',
      pincode: appToEdit.pincode || '',
      incomeTask: appToEdit.incomeTask || '',
      aadharCard: appToEdit.aadharCard || null,
      panCard: appToEdit.panCard || null,
      incomeTaxProof: appToEdit.incomeTaxProof || null
    });
    setHasActiveApplication(false);
    // Clear the location state
    window.history.replaceState({}, document.title);
  }
};
  const handleInputChange = (e) => {
    const { name, value } = e.target;
    setFormData(prev => ({
      ...prev,
      [name]: value
    }));
    if (errors[name]) {
      setErrors(prev => ({ ...prev, [name]: '' }));
    }
  };

  const handleFileChange = (e, type) => {
    const file = e.target.files[0];
    if (file) {
      setUploadingFiles(prev => ({ ...prev, [type]: true }));
      
      setTimeout(() => {
        const reader = new FileReader();
        reader.onloadend = () => {
          const fieldName = type === 'aadhar' ? 'aadharCard' : type === 'pan' ? 'panCard' : 'incomeTaxProof';
          setFormData(prev => ({
            ...prev,
            [fieldName]: {
              name: file.name,
              data: reader.result
            }
          }));
          setUploadingFiles(prev => ({ ...prev, [type]: false }));
        };
        reader.readAsDataURL(file);
      }, 1500);
    }
  };

  const validateForm = () => {
    const newErrors = {};
    if (!formData.firstName.trim()) newErrors.firstName = 'First name is required';
    if (!formData.lastName.trim()) newErrors.lastName = 'Last name is required';
    if (!formData.email.trim()) newErrors.email = 'Email is required';
    else if (!/\S+@\S+\.\S+/.test(formData.email)) newErrors.email = 'Email is invalid';
    if (!formData.contactNumber.trim()) newErrors.contactNumber = 'Contact number is required';
    else if (!/^\d{10}$/.test(formData.contactNumber)) newErrors.contactNumber = 'Contact number must be 10 digits';
    if (!formData.address.trim()) newErrors.address = 'Address is required';
    if (!formData.city.trim()) newErrors.city = 'City is required';
    if (!formData.pincode.trim()) newErrors.pincode = 'Pincode is required';
    else if (!/^\d{6}$/.test(formData.pincode)) newErrors.pincode = 'Pincode must be 6 digits';
    if (!formData.incomeTask.trim()) newErrors.incomeTask = 'Income details are required';
    if (!formData.aadharCard) newErrors.aadharCard = 'Aadhar card is required';
    if (!formData.panCard) newErrors.panCard = 'PAN card is required';
    if (!formData.incomeTaxProof) newErrors.incomeTaxProof = 'Income tax proof is required';
    
    setErrors(newErrors);
    return Object.keys(newErrors).length === 0;
  };

  const handleSubmit = (e) => {
  e.preventDefault();
  if (validateForm()) {
    const applicationId = editingApplicationId || Date.now().toString();
    const dataToSave = {
      ...formData,
      id: applicationId,
      submittedAt: new Date().toISOString(),
      status: 'in-process'
    };
    
    // Save current application
    localStorage.setItem('creditCardApplication', JSON.stringify(dataToSave));
    
    // Add to history
    const allApps = JSON.parse(localStorage.getItem('allApplications') || '[]');
    if (editingApplicationId) {
      // Update existing application in history
      const updatedApps = allApps.map(app => 
        app.id === editingApplicationId ? dataToSave : app
      );
      localStorage.setItem('allApplications', JSON.stringify(updatedApps));
      setApplicationHistory(updatedApps);
    } else {
      // Add new application to history
      allApps.unshift(dataToSave); // Add to beginning
      localStorage.setItem('allApplications', JSON.stringify(allApps));
      setApplicationHistory(allApps);
    }
      
      setSubmittedData(dataToSave);
      setIsEditing(false);
      setEditingApplicationId(null);
      setHasActiveApplication(true);
      setShowSuccessMessage(true);
      
      // Reset form
      setFormData({
        firstName: '',
        lastName: '',
        email: '',
        contactNumber: '',
        cardType: 'gold',
        address: '',
        city: '',
        pincode: '',
        incomeTask: '',
        aadharCard: null,
        panCard: null,
        incomeTaxProof: null
      });

      // Redirect to status page after showing success message
      setTimeout(() => {
        setShowSuccessMessage(false);
        navigate('/status');
      }, 2000);
    }
  };

  const handleCancel = () => {
    setIsEditing(false);
    setEditingApplicationId(null);
    setFormData({
      firstName: '',
      lastName: '',
      email: '',
      contactNumber: '',
      cardType: 'gold',
      address: '',
      city: '',
      pincode: '',
      incomeTask: '',
      aadharCard: null,
      panCard: null,
      incomeTaxProof: null
    });
    // Navigate back to status page
    navigate('/status');
  };

  const handleNewApplication = () => {
    // Clear current application from localStorage
    localStorage.removeItem('creditCardApplication');
    
    setIsEditing(false);
    setEditingApplicationId(null);
    setShowHistory(false);
    setHasActiveApplication(false);
    setSubmittedData(null);
    setShowSuccessMessage(false);
    setFormData({
      firstName: '',
      lastName: '',
      email: '',
      contactNumber: '',
      cardType: 'gold',
      address: '',
      city: '',
      pincode: '',
      incomeTask: '',
      aadharCard: null,
      panCard: null,
      incomeTaxProof: null
    });
  };

  const toggleHistory = () => {
    setShowHistory(!showHistory);
  };

  const getStatusBadgeClass = (status) => {
    switch(status) {
      case 'approved': return 'status-approved';
      case 'rejected': return 'status-rejected';
      case 'in-process': return 'status-process';
      default: return '';
    }
  };

  const getStatusText = (status) => {
    switch(status) {
      case 'approved': return 'Approved';
      case 'rejected': return 'Rejected';
      case 'in-process': return 'In Process';
      default: return status;
    }
  };

 

  return (
    <div className="application-container">
      {/* Success Message */}
      {showSuccessMessage && (
        <div className="success-toast">
          <div className="success-toast-content">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor">
              <path d="M9 12l2 2 4-4"/>
              <circle cx="12" cy="12" r="10"/>
            </svg>
            <span>Application submitted successfully! Redirecting to status page...</span>
          </div>
        </div>
      )}

      <div className="form-header">
        <h1 className="form-title">Credit Card Application</h1>
        <p className="form-subtitle">
          {isEditing ? 'Edit and resubmit your application' : 'Fill in your details to apply for a credit card'}
        </p>
      </div>

      {/* Application History Toggle - Don't show when editing */}
      {applicationHistory.length > 0 && !isEditing && !hasActiveApplication && (
        <div className="history-toggle-section">
          <button className="history-toggle-btn" onClick={toggleHistory}>
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
              <circle cx="12" cy="12" r="10"/>
              <polyline points="12 6 12 12 16 14"/>
            </svg>
            {showHistory ? 'Hide' : 'View'} Application History ({applicationHistory.length})
          </button>
        </div>
      )}

      {/* Application History */}
      {showHistory && applicationHistory.length > 0 && !isEditing && (
        <div className="history-container">
          <h2 className="history-title">Previous Applications</h2>
          <div className="history-list">
            {applicationHistory.map((app) => (
              <div key={app.id} className="history-card">
                <div className="history-header">
                  <div className="history-info">
                    <h3 className="history-name">{app.firstName} {app.lastName}</h3>
                    <p className="history-date">
                      Application ID: {app.id}
                    </p>
                    <p className="history-date">
                      {new Date(app.submittedAt).toLocaleDateString('en-IN', {
                        day: 'numeric',
                        month: 'short',
                        year: 'numeric'
                      })}
                    </p>
                  </div>
                  <span className={`status-badge ${getStatusBadgeClass(app.status)}`}>
                    {getStatusText(app.status)}
                  </span>
                </div>
                
                <div className="history-details">
                  <div className="history-detail-item">
                    <span className="history-label">Card Type:</span>
                    <span className="history-value">{app.cardType}</span>
                  </div>
                  <div className="history-detail-item">
                    <span className="history-label">Email:</span>
                    <span className="history-value">{app.email}</span>
                  </div>
                  <div className="history-detail-item">
                    <span className="history-label">Contact:</span>
                    <span className="history-value">{app.contactNumber}</span>
                  </div>
                </div>

                {app.rejectionReason && (
                  <div className="rejection-info">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                      <circle cx="12" cy="12" r="10"/>
                      <line x1="12" y1="8" x2="12" y2="12"/>
                      <line x1="12" y1="16" x2="12.01" y2="16"/>
                    </svg>
                    <span className="rejection-text">{app.rejectionReason}</span>
                  </div>
                )}

                
              </div>
            ))}
          </div>
        </div>
      )}

      {/* Block new application if there's an active one */}
      {hasActiveApplication && !isEditing && submittedData?.status === 'in-process' ? (
  <div className="active-application-block">
    <div className="block-icon">
      <svg width="60" height="60" viewBox="0 0 24 24" fill="none" stroke="#f59e0b" strokeWidth="2">
        <circle cx="12" cy="12" r="10"/>
        <line x1="12" y1="8" x2="12" y2="12"/>
        <line x1="12" y1="16" x2="12.01" y2="16"/>
      </svg>
    </div>
    <h2 className="block-title">Application In Progress</h2>
    <p className="block-message">
      You already have an active credit card application being processed. 
      You cannot submit a new application until your current one is completed.
    </p>
    <div className="block-actions">
      <button className="view-status-btn" onClick={() => navigate('/status')}>
        View Application Status
      </button>
    </div>
  </div>
) : submittedData?.status === 'rejected' && !isEditing ? (
  <div className="active-application-block">
    <div className="block-icon">
      <svg width="60" height="60" viewBox="0 0 24 24" fill="none" stroke="#dc2626" strokeWidth="2">
        <circle cx="12" cy="12" r="10"/>
        <line x1="12" y1="8" x2="12" y2="12"/>
        <line x1="12" y1="16" x2="12.01" y2="16"/>
      </svg>
    </div>
    <h2 className="block-title">Application Rejected</h2>
    <p className="block-message">
      Your application was rejected. {submittedData.rejectionReason}
    </p>
    <div className="block-actions">
      <button 
        className="edit-application-btn" 
        onClick={() => {
          setIsEditing(true);
          setEditingApplicationId(submittedData.id);
          setFormData({
            firstName: submittedData.firstName || '',
            lastName: submittedData.lastName || '',
            email: submittedData.email || '',
            contactNumber: submittedData.contactNumber || '',
            cardType: submittedData.cardType || 'gold',
            address: submittedData.address || '',
            city: submittedData.city || '',
            pincode: submittedData.pincode || '',
            incomeTask: submittedData.incomeTask || '',
            aadharCard: submittedData.aadharCard || null,
            panCard: submittedData.panCard || null,
            incomeTaxProof: submittedData.incomeTaxProof || null
          });
          setHasActiveApplication(false);
        }}
      >
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
          <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"/>
          <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"/>
        </svg>
        Edit & Resubmit Application
      </button>
    </div>
  </div>
) : (
        <form onSubmit={handleSubmit} className="application-form">
          <div className="form-section">
            <h3 className="section-title">Personal Information</h3>
            
            <div className="form-grid">
              <div className="form-group">
                <label className="form-label">First Name *</label>
                <input
                  type="text"
                  name="firstName"
                  value={formData.firstName}
                  onChange={handleInputChange}
                  className={`form-input ${errors.firstName ? 'error' : ''}`}
                  placeholder="John"
                />
                {errors.firstName && <span className="error-text">{errors.firstName}</span>}
              </div>

              <div className="form-group">
                <label className="form-label">Last Name *</label>
                <input
                  type="text"
                  name="lastName"
                  value={formData.lastName}
                  onChange={handleInputChange}
                  className={`form-input ${errors.lastName ? 'error' : ''}`}
                  placeholder="Doe"
                />
                {errors.lastName && <span className="error-text">{errors.lastName}</span>}
              </div>
            </div>

            <div className="form-grid">
              <div className="form-group">
                <label className="form-label">Email Address *</label>
                <input
                  type="email"
                  name="email"
                  value={formData.email}
                  onChange={handleInputChange}
                  className={`form-input ${errors.email ? 'error' : ''}`}
                  placeholder="john.doe@example.com"
                />
                {errors.email && <span className="error-text">{errors.email}</span>}
              </div>

              <div className="form-group">
                <label className="form-label">Contact Number *</label>
                <input
                  type="tel"
                  name="contactNumber"
                  value={formData.contactNumber}
                  onChange={handleInputChange}
                  className={`form-input ${errors.contactNumber ? 'error' : ''}`}
                  placeholder="9876543210"
                  maxLength="10"
                />
                {errors.contactNumber && <span className="error-text">{errors.contactNumber}</span>}
              </div>
            </div>
          </div>

          <div className="form-section">
            <h3 className="section-title">Address Details</h3>
            
            <div className="form-group">
              <label className="form-label">Address *</label>
              <textarea
                name="address"
                value={formData.address}
                onChange={handleInputChange}
                className={`form-input ${errors.address ? 'error' : ''}`}
                placeholder="Enter your complete address"
                rows="3"
              />
              {errors.address && <span className="error-text">{errors.address}</span>}
            </div>

            <div className="form-grid">
              <div className="form-group">
                <label className="form-label">City *</label>
                <input
                  type="text"
                  name="city"
                  value={formData.city}
                  onChange={handleInputChange}
                  className={`form-input ${errors.city ? 'error' : ''}`}
                  placeholder="Mumbai"
                />
                {errors.city && <span className="error-text">{errors.city}</span>}
              </div>

              <div className="form-group">
                <label className="form-label">Pincode *</label>
                <input
                  type="text"
                  name="pincode"
                  value={formData.pincode}
                  onChange={handleInputChange}
                  className={`form-input ${errors.pincode ? 'error' : ''}`}
                  placeholder="400001"
                  maxLength="6"
                />
                {errors.pincode && <span className="error-text">{errors.pincode}</span>}
              </div>
            </div>
          </div>

          <div className="form-section">
            <h3 className="section-title">Card & Income Details</h3>
            
            <div className="form-grid">
              <div className="form-group">
                <label className="form-label">Card Type *</label>
                <div className="select-wrapper">
                  <select
                    name="cardType"
                    value={formData.cardType}
                    onChange={handleInputChange}
                    className="form-select"
                  >
                    <option value="gold">Gold Card</option>
                    <option value="silver">Silver Card</option>
                    <option value="platinum">Platinum Card</option>
                  </select>
                  <svg className="select-arrow" width="12" height="8" viewBox="0 0 12 8" fill="none">
                    <path d="M1 1L6 6L11 1" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"/>
                  </svg>
                </div>
              </div>

              <div className="form-group">
                <label className="form-label">Annual Income *</label>
                <input
                  type="text"
                  name="incomeTask"
                  value={formData.incomeTask}
                  onChange={handleInputChange}
                  className={`form-input ${errors.incomeTask ? 'error' : ''}`}
                  placeholder="e.g., â‚¹5,00,000"
                />
                {errors.incomeTask && <span className="error-text">{errors.incomeTask}</span>}
              </div>
            </div>
          </div>

          <div className="form-section">
            <h3 className="section-title">Document Upload</h3>
            
            <div className="form-grid">
              <div className="form-group">
                <label className="form-label">Aadhar Card *</label>
                <div className={`file-upload ${errors.aadharCard ? 'error' : ''}`}>
                  <input
                    type="file"
                    id="aadhar"
                    accept="image/*,.pdf"
                    onChange={(e) => handleFileChange(e, 'aadhar')}
                    className="file-input"
                  />
                  <label htmlFor="aadhar" className="file-label">
                    {uploadingFiles.aadhar ? (
                      <div className="upload-loading">
                        <div className="spinner"></div>
                        <span>Uploading...</span>
                      </div>
                    ) : formData.aadharCard ? (
                      <div className="file-uploaded">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                          <path d="M9 12l2 2 4-4"/>
                          <circle cx="12" cy="12" r="10"/>
                        </svg>
                        <span>{formData.aadharCard.name}</span>
                      </div>
                    ) : (
                      <div className="file-placeholder">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                          <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
                          <polyline points="17 8 12 3 7 8"/>
                          <line x1="12" y1="3" x2="12" y2="15"/>
                        </svg>
                        <span>Upload Aadhar Card</span>
                      </div>
                    )}
                  </label>
                </div>
                {errors.aadharCard && <span className="error-text">{errors.aadharCard}</span>}
              </div>

              <div className="form-group">
                <label className="form-label">PAN Card *</label>
                <div className={`file-upload ${errors.panCard ? 'error' : ''}`}>
                  <input
                    type="file"
                    id="pan"
                    accept="image/*,.pdf"
                    onChange={(e) => handleFileChange(e, 'pan')}
                    className="file-input"
                  />
                  <label htmlFor="pan" className="file-label">
                    {uploadingFiles.pan ? (
                      <div className="upload-loading">
                        <div className="spinner"></div>
                        <span>Uploading...</span>
                      </div>
                    ) : formData.panCard ? (
                      <div className="file-uploaded">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                          <path d="M9 12l2 2 4-4"/>
                          <circle cx="12" cy="12" r="10"/>
                        </svg>
                        <span>{formData.panCard.name}</span>
                      </div>
                    ) : (
                      <div className="file-placeholder">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                          <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
                          <polyline points="17 8 12 3 7 8"/>
                          <line x1="12" y1="3" x2="12" y2="15"/>
                        </svg>
                        <span>Upload PAN Card</span>
                      </div>
                    )}
                  </label>
                </div>
                {errors.panCard && <span className="error-text">{errors.panCard}</span>}
              </div>
            </div>

            <div className="form-group">
              <label className="form-label">Income Tax Proof *</label>
              <div className={`file-upload ${errors.incomeTaxProof ? 'error' : ''}`}>
                <input
                  type="file"
                  id="incomeTax"
                  accept="image/*,.pdf"
                  onChange={(e) => handleFileChange(e, 'incomeTax')}
                  className="file-input"
                />
                <label htmlFor="incomeTax" className="file-label">
                  {uploadingFiles.incomeTax ? (
                    <div className="upload-loading">
                      <div className="spinner"></div>
                      <span>Uploading...</span>
                    </div>
                  ) : formData.incomeTaxProof ? (
                    <div className="file-uploaded">
                      <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                        <path d="M9 12l2 2 4-4"/>
                        <circle cx="12" cy="12" r="10"/>
                      </svg>
                      <span>{formData.incomeTaxProof.name}</span>
                    </div>
                  ) : (
                    <div className="file-placeholder">
                      <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                        <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
                        <polyline points="17 8 12 3 7 8"/>
                        <line x1="12" y1="3" x2="12" y2="15"/>
                      </svg>
                      <span>Upload Income Tax Proof</span>
                    </div>
                  )}
                </label>
              </div>
              {errors.incomeTaxProof && <span className="error-text">{errors.incomeTaxProof}</span>}
            </div>
          </div>

          <div className="form-actions">
            {isEditing && (
              <button type="button" className="cancel-button" onClick={handleCancel}>
                Cancel
              </button>
            )}
            <button type="submit" className="submit-button">
              <span>{isEditing ? 'Resubmit Application' : 'Submit Application'}</span>
              <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                <line x1="5" y1="12" x2="19" y2="12"/>
                <polyline points="12 5 19 12 12 19"/>
              </svg>
            </button>
          </div>
        </form>
      )}
    </div>
  );
};




